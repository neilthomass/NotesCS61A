<!doctype html><html lang=en dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Macros and Exceptions
  #


  Macros
  #

In Scheme, everything is a list. For example, (quotient 1 2) can also be seen as a Scheme list with the elements quotient, 1, and 2. What the &rsquo; operator lets us do in Scheme is create a list without evaluating certain options, then delay the evaluation until you need it later. For example:
>>> (define lst (list 'quotient 1 2))
lst
>>> lst
(quotient 1 2)
>>> (eval lst)
0.5
>>> (eval (list 'quotient 1 2))
0.5

  Quoting
  #

There are two ways to quote an expression:"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:1313/docs/week-11/macros-exceptions/"><meta property="og:site_name" content="CS61A NT"><meta property="og:title" content="Macros and Exceptions"><meta property="og:description" content="Macros and Exceptions # Macros # In Scheme, everything is a list. For example, (quotient 1 2) can also be seen as a Scheme list with the elements quotient, 1, and 2. What the â€™ operator lets us do in Scheme is create a list without evaluating certain options, then delay the evaluation until you need it later. For example:
>>> (define lst (list 'quotient 1 2)) lst >>> lst (quotient 1 2) >>> (eval lst) 0.5 >>> (eval (list 'quotient 1 2)) 0.5 Quoting # There are two ways to quote an expression:"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>Macros and Exceptions | CS61A NT</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=http://localhost:1313/docs/week-11/macros-exceptions/><link rel=stylesheet href=/book.min.a7616cf2799b58bddffce9438e31fdbfc6393687cfc0950a4a17cd1cce7e35f6.css integrity="sha256-p2Fs8nmbWL3f/OlDjjH9v8Y5NofPwJUKShfNHM5+NfY=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.1e2586cdf1cb64d922f6d441cefa426d5824b54d6cf001ad35c3d5d4d2b65747.js integrity="sha256-HiWGzfHLZNki9tRBzvpCbVgktU1s8AGtNcPV1NK2V0c=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>CS61A NT</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href target=_blank rel=noopener></a></li></ul><ul><li class=book-section-flat><span>Week 1</span><ul><li><a href=/docs/week-1/basics-of-python/>Basics of Python</a></li></ul></li><li class=book-section-flat><span>Week 2</span><ul><li><a href=/docs/week-2/control/>Control</a></li><li><a href=/docs/week-2/higher-order-functions/>Higher Order Functions</a></li><li><a href=/docs/week-2/environment-diagrams/>Environment Diagrams</a></li></ul></li><li><a href=/docs/week-11/calculator-language/>Calculator Language</a></li><li><a href=/docs/week-5/containers/>Containers</a></li><li><a href=/docs/week-5/data-abstraction/>Data Abstraction</a></li><li><a href=/docs/week-3/decorators/>Decorators</a></li><li><a href=/docs/week-3/design/>Design</a></li><li><a href=/docs/week-9/efficiency/>Efficiency</a></li><li><a href=/docs/week-7/generators/>Generators</a></li><li><a href=/docs/week-8/inheritance/>Inheritance</a></li><li><a href=/docs/week-7/iterators/>Iterators</a></li><li><a href=/docs/week-11/macros-exceptions/ class=active>Macros and Exceptions</a></li><li><a href=/docs/week-6/mutability/>Mutability</a></li><li><a href=/docs/week-10/break/>No Content This Week</a></li><li><a href=/docs/week-7/objects/>Objects</a></li><li><a href=/docs/week-4/recursion/>Recursion</a></li><li><a href=/docs/week-8/recursive-data/>Recursive Data</a></li><li><a href=/docs/week-11/scheme/>Scheme</a></li><li><a href=/docs/week-5/sequences/>Sequences</a></li><li><a href=/docs/week-8/representation/>String Interpolation and Representation</a></li><li><a href=/docs/week-4/tree-recursion/>Tree Recursion</a></li><li><a href=/docs/week-6/trees/>Trees</a></li></ul><ul><li><a href=https://linkedin.com/in/neiltthomas target=_blank rel=noopener>Linkedin</a></li><li><a href=neilthomas@berkeley.edu target=_blank rel=noopener>Email</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Macros and Exceptions</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#macros-and-exceptions>Macros and Exceptions</a><ul><li><a href=#macros>Macros</a><ul><li><a href=#quoting>Quoting</a></li></ul></li><li><a href=#exceptions>Exceptions</a><ul><li><a href=#tryexcept>try&mldr;except</a></li><li><a href=#example>Example</a></li><li><a href=#example-inside-a-function>Example inside a function</a></li><li><a href=#what-would-python-do>What Would Python Do?</a></li><li><a href=#raising-exceptions>Raising Exceptions</a></li></ul></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=macros-and-exceptions>Macros and Exceptions
<a class=anchor href=#macros-and-exceptions>#</a></h1><h2 id=macros>Macros
<a class=anchor href=#macros>#</a></h2><p>In Scheme, everything is a list. For example, <code>(quotient 1 2)</code> can also be seen as a Scheme list with the elements quotient, 1, and 2. What the &rsquo; operator lets us do in Scheme is create a list without evaluating certain options, then delay the evaluation until you need it later. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>&gt;&gt;&gt; (<span style=color:#66d9ef>define </span>lst (list <span style=color:#e6db74>&#39;quotient</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>lst
</span></span><span style=display:flex><span>&gt;&gt;&gt; lst
</span></span><span style=display:flex><span>(quotient <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>&gt;&gt;&gt; (eval lst)
</span></span><span style=display:flex><span><span style=color:#ae81ff>0.5</span>
</span></span><span style=display:flex><span>&gt;&gt;&gt; (eval (list <span style=color:#e6db74>&#39;quotient</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span><span style=color:#ae81ff>0.5</span>
</span></span></code></pre></div><h3 id=quoting>Quoting
<a class=anchor href=#quoting>#</a></h3><p>There are two ways to quote an expression:</p><ol><li>Quoting</li><li>Quasiquoting</li></ol><p>Quasiquotes are different because they allow certain elements to be unquoted using <code>,</code>. This means that names can be bound directly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scheme data-lang=scheme><span style=display:flex><span>(<span style=color:#66d9ef>define </span>a <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>define </span>b <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&#39;</span>(+ <span style=color:#f92672>,</span>a b) <span style=color:#75715e>; (+ (unquote (a)) b)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>`</span>(+ <span style=color:#f92672>,</span>a b) <span style=color:#75715e>; (+ 2 b)</span>
</span></span></code></pre></div><p>When you call eval on the quasiquoted expression, it saves the value of a directly into the macro which can be very powerful.</p><p>If you try to call <code>(eval '(+ ,a b))</code> you will get an error because <code>,</code> does not work unless it is in a quasiquote because Scheme.</p><h2 id=exceptions>Exceptions
<a class=anchor href=#exceptions>#</a></h2><p>Exceptions in Python are used to handle errors. In Python, you most likely would have seen quite a few exceptions (for example ZeroDivisionError, StopIteration, etc.) - there is a way to handle these exceptions.</p><h3 id=tryexcept>try&mldr;except
<a class=anchor href=#tryexcept>#</a></h3><p>To handle an exception (which keeps the program running - it doesn&rsquo;t make the program stop the moment an error appears), you can use Python&rsquo;s built-in exception handling.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;</span>body<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#f92672>&lt;</span>exception<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>as</span> <span style=color:#f92672>&lt;</span>variable<span style=color:#f92672>&gt;</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;</span>body<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>[<span style=color:#66d9ef>except</span> <span style=color:#f92672>&lt;</span>exception<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>as</span> <span style=color:#f92672>&lt;</span>variable<span style=color:#f92672>&gt;</span> [<span style=color:#f92672>...</span>]]
</span></span><span style=display:flex><span>[<span style=color:#66d9ef>else</span>]
</span></span></code></pre></div><p>First, the body in the try suite is executed first, then if an error is thrown that matches any <code>&lt;exception></code> that you put in, the body corresponding to that suite will be run with <code>&lt;variable></code> bound to the exception.</p><h3 id=example>Example
<a class=anchor href=#example>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    val <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ZeroDivisionError</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;handling </span><span style=color:#e6db74>{</span>type(e)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>) <span style=color:#75715e># handling &lt;class &#39;ZeroDivisionError&#39;&gt;</span>
</span></span><span style=display:flex><span>    val <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h3 id=example-inside-a-function>Example inside a function
<a class=anchor href=#example-inside-a-function>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>div</span>(a, b):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> a <span style=color:#f92672>/</span> b
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ZeroDivisionError</span>:
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> float(<span style=color:#e6db74>&#39;inf&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>div(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>1</span>) <span style=color:#75715e># 10</span>
</span></span><span style=display:flex><span>div(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>0</span>) <span style=color:#75715e># inf</span>
</span></span><span style=display:flex><span>div(<span style=color:#ae81ff>10</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#75715e># -10</span>
</span></span></code></pre></div><h3 id=what-would-python-do>What Would Python Do?
<a class=anchor href=#what-would-python-do>#</a></h3><p>Taken from CS61A Fall 2021 Exceptions slides:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>invert</span>(x):
</span></span><span style=display:flex><span>    inverse <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span>x <span style=color:#75715e># Raises a ZeroDivisionError if x is 0</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;Never printed if x is 0&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inverse
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>invert_safe</span>(x):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> invert(x)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ZeroDivisionError</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;ben&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>invert_safe(<span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>) <span style=color:#75715e># Error</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    invert_safe(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ZeroDivisionError</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;tao&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># ben</span>
</span></span><span style=display:flex><span><span style=color:#75715e># this is because the place where the error occurs is in the try except block where &#39;ben&#39; is printed</span>
</span></span></code></pre></div><h3 id=raising-exceptions>Raising Exceptions
<a class=anchor href=#raising-exceptions>#</a></h3><h4 id=assert-statements>Assert Statements
<a class=anchor href=#assert-statements>#</a></h4><p>assert statements that fail raise an exception of type AssertionError</p><h4 id=raise-statement>Raise Statement
<a class=anchor href=#raise-statement>#</a></h4><p>You can raise any type of exception by using the raise statement:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>raise</span> <span style=color:#f92672>&lt;</span>expression<span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><p><code>&lt;exception></code> must evaluate to a subclass of BaseException (or an instance of one). Exceptions are constructed in the same way as do other classes:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ZeroDivisionError</span>(<span style=color:#e6db74>&#34;lol wtf u doing&#34;</span>)
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#macros-and-exceptions>Macros and Exceptions</a><ul><li><a href=#macros>Macros</a><ul><li><a href=#quoting>Quoting</a></li></ul></li><li><a href=#exceptions>Exceptions</a><ul><li><a href=#tryexcept>try&mldr;except</a></li><li><a href=#example>Example</a></li><li><a href=#example-inside-a-function>Example inside a function</a></li><li><a href=#what-would-python-do>What Would Python Do?</a></li><li><a href=#raising-exceptions>Raising Exceptions</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>